!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=121)}({121:function(e,t){CustomFunctions.associate("MW_GET_FROM_CLOUD",(function(e){return new Promise((function(t,n){OfficeRuntime.storage.getItem("owner").then((function(n){OfficeRuntime.storage.getItem("source").then((function(o){var r="https://excel-endpoint.vercel.app/api/getData?symbol="+e+"&source="+o+"&owner="+n,i={method:"GET",headers:{"Content-Type":"application/json"}},a=0;!function e(){fetch(r,i).then((function(e){return e.json()})).then((function(e){console.log(e[0].timeSeries[0].price);var n=[];n.push(["asOf",e[0].asOf]),n.push(["name",e[0].name]),n.push(["owner",e[0].owner]),n.push(["source",e[0].source]),n.push(["symbol",e[0].symbol]),n.push(["last",e[0].last+""]),n.push(["timeSeries",""]),n.push(["Date","Price"]),e[0].timeSeries.forEach((function(e){var t=[];t.push(e.date),t.push(e.price+""),n.push(t)})),t(n)})).catch((function(n){if(a++<3)e();else{var o=[];o.push(["error",JSON.stringify(n)]),t(o)}}))}()}))}))}))})),CustomFunctions.associate("MW_WRITE_TO_CLOUD",(function(e,t,n,o,r){var i=function(e){var t=Math.floor(e-25569),n=new Date(1e3*(86400*t)),o=e-Math.floor(e)+1e-7,r=Math.floor(86400*o),i=r%60;r-=i;var a=Math.floor(r/3600),u=Math.floor(r/60)%60;return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),a,u,i)};return new Promise((function(a,u){var s=[];OfficeRuntime.storage.getItem("owner").then((function(u){OfficeRuntime.storage.getItem("source").then((function(c){r.forEach((function(e,t){var n=i(e[0]),o=new Date(n);startDate=o.getUTCFullYear()+"-"+("0"+(o.getUTCMonth()+1)).slice(-2)+"-"+("0"+o.getUTCDate()).slice(-2),s.push({date:startDate,price:e[1]})}));var f=i(e),l=new Date(f);f=l.getUTCFullYear()+"-"+("0"+(l.getUTCMonth()+1)).slice(-2)+"-"+("0"+l.getUTCDate()).slice(-2);var p={timeSeries:s,symbol:n,name:t,owner:u,source:c,asOf:f,last:o};console.log(p);var h={method:"POST",headers:{"Content-Type":"text/plain",Accept:"application/json"},body:JSON.stringify(p)},m=0;!function e(){fetch("https://excel-endpoint.vercel.app/api/postData",h).then((function(e){return e.json()})).then((function(e){e.success?a("Saved to Server asof "+f):a(JSON.stringify(e))})).catch((function(t){m++<3?e():a(JSON.stringify(t))}))}()}))}))}))}))}});
//# sourceMappingURL=functions.js.map